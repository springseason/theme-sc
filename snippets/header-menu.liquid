<!--
  links: section.settings.menu.links
  colors
  menu_colors
-->
<ul class="header-menu gap-4 xl:gap-8">
  {% for link in links %}
    {%- assign id = link.title | downcase | prepend: 'nav-' -%}
    <li
      id="{{ id }}"
      class="flex items-center h-16 px-2 decoration-none cursor-pointer"
      {%- if link.links != blank -%}
        x-data="{ open: false }"
        @mouseenter="open = true"
        @mouseleave="open = false"
        aria-haspopup="true"
        :aria-expanded="open ? 'true' : 'false'"
      {%- endif -%}
    >
      {%- if link.links != blank -%}
        <div class="relative flex">
          <!--
            Item active: "border-indigo-600 text-indigo-600", Item inactive: "border-transparent text-gray-700 hover:text-gray-800"
          -->
          <button
            type="button"
            class="{% if link.active %}active{% endif %}"
            aria-controls="{{ id }}"
            :aria-expanded="open ? 'true' : 'false'"
          >
            {{ link.title }}
          </button>
        </div>

        <!--
          Entering: "transition ease-out duration-200"
            From: "opacity-0"
            To: "opacity-100"
          Leaving: "transition ease-in duration-150"
            From: "opacity-100"
            To: "opacity-0"
        -->
        <div
          class="absolute inset-x-0 top-full sm:text-sm mega-menu"
          x-cloak
          x-transition
          x-show="open"
        >
          <!--
            Presentational element used to render the bottom shadow, if we put the shadow on the actual panel it pokes out the top, so we use this shorter element to hide the top of the shadow
          -->
          <div class="absolute inset-0 top-1/2 shadow" aria-hidden="true"></div>

          <div class="relative">
            <div class="mx-auto max-w-7xl px-8">
              <div class="grid grid-cols-2 items-start gap-x-8 gap-y-10 pb-12 pt-10">
                <div class="grid grid-cols-2 gap-x-8 gap-y-10">
                  {%- for childlink in link.links -%}
                    <div>
                      {%- if childlink.links != blank -%}
                        <p id="desktop-featured-heading-0" class="font-medium">
                          {{ childlink.title }}
                        </p>
                        <ul
                          role="list"
                          aria-labelledby="desktop-featured-heading-0"
                          class="mt-6 space-y-6 sm:mt-4 sm:space-y-4"
                        >
                          {%- for link in childlink.links -%}
                            <li class="flex">
                              <a href="{{ link.url }}">
                                {{- link.title -}}
                              </a>
                            </li>
                          {%- endfor -%}
                        </ul>
                      {%- else -%}
                        <a
                          href="{{ childlink.url }}"
                          class="flex items-center text-sm font-medium"
                        >
                          {{ childlink.title | escape }}
                        </a>
                      {%- endif -%}
                    </div>
                  {%- endfor -%}
                </div>
              </div>
            </div>
          </div>
        </div>
      {%- else -%}
        <a
          href="{{ link.url }}"
          {% if link.active %}
            class="active"
          {% endif %}
        >
          {{ link.title | escape }}
        </a>
      {%- endif -%}
    </li>
  {% endfor %}
</ul>

<style>
  .header-menu {
    display: flex;
    align-items: center;
    padding: 0 1rem;
  }
  .header-menu > li {
    color: {{ colors.text }};
  }
  .header-menu > li:hover {
    color: {{ colors.hover }};
  }
  .header-menu button {
    -webkit-appearance: none;
    appearance: none;
    -moz-appearance: none;
    background: none;
    border: none;
  }

  {% comment %}
    MEGA MENU
  {% endcomment %}
  .mega-menu {
    background-color: {{ menu_colors.background }};
  }
  .mega-menu a,
  .mega-menu p {
    color: {{ menu_colors.text }};
  }
  .mega-menu a:hover {
    color: {{ menu_colors.hover }};
  }
  .mega-menu :not(a) {
    cursor: default;
  }
</style>
